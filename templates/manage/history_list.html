{% extends 'base.html' %}
{% load static %}

{% block title %}Исторические линии (Админ){% endblock %}

{% block extra_css %}
<link href="{% static 'css/history_lines.css' %}" rel="stylesheet">
<style>
    .plus { display: block; background: none; border: none; cursor: pointer; margin: 0 auto; margin-bottom: 20px; }
    .edit-btn-box { display: flex; gap: 10px; align-items: center; margin-top: 10px; }
</style>
{% endblock %}

{% block header_logo %}logo_blue.png{% endblock %}
{% block burger_icon %}menu_blue.png{% endblock %}

{% block nav_title %}
<h1>Исторические линии</h1>
{% endblock %}

{% block content %}
    <div style="display: flex; justify-content: center; margin-bottom: 20px;">
        <a href="{% url 'history_add' %}" class="plus">
            <img src="{% static 'img/plus.png' %}" width="100" height="100" alt="Добавить">
        </a>
    </div>

    {% for line in lines %}
        <section class="history-lines">
            <div class="history-lines-content {% if forloop.counter|divisibleby:2 %}left{% endif %}">
                {% if not forloop.counter|divisibleby:2 %}
                    <a href="{% url 'history_detail' line.pk %}"><img src="{{ line.image.url }}" width="250px" height="250px" alt="{{ line.title }}" style="object-fit: contain; background: #fff;"></a>
                {% endif %}
                
                <div class="history-lines-text" style="position: relative;">
                    <h3>{{ line.title|safe }}</h3>
                    <p>{{ line.description }}</p>
                    
                    {# Кнопки управления - иконки, абсолютное позиционирование #}
                    <div class="edit-btn-box" style="position: absolute; top: 0; right: 0; display: flex; gap: 10px; z-index: 10;">
                        <a href="{% url 'history_edit' line.pk %}" class="admin-icon-link">
                            <img src="{% static 'img/edit.png' %}" class="admin-icon">
                        </a>
                        <a href="{% url 'history_delete' line.pk %}" onclick="return confirm('Удалить?');" class="admin-icon-link">
                            <img src="{% static 'img/close.png' %}" class="admin-icon" style="filter: brightness(0) !important;">
                        </a>
                    </div>
                </div>
                <a href="{% url 'history_detail' line.pk %}">Смотреть</a><img src="{% static 'img/show.png' %}" class="show" width="32px" height="32px">

                {% if forloop.counter|divisibleby:2 %}
                    <a href="{% url 'history_detail' line.pk %}"><img src="{{ line.image.url }}" width="250px" height="250px" alt="{{ line.title }}" style="object-fit: contain; background: #fff;"></a>
                {% endif %}
            </div>
        </section>
        
        {% if not forloop.last %}
            <img src="{% static 'img/volna_' %}{% if forloop.counter|divisibleby:2 %}down{% else %}up{% endif %}.png" class="volna" alt="Волна">
        {% endif %}
    {% endfor %}
{% endblock %}
